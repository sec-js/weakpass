{
  "openapi": "3.0.3",
  "info": {
    "title": "Weakpass - API",
    "description": "The Weakpass REST API provides flexible methods to ensure users aren't using weak or compromised passwords, while also simplifying hash-cracking challenges.\n- [OpenAPI.yaml](/openapi.yaml)",
    "version": "1.1.0"
  },
  "servers": [
    {
      "url": "/api/v1"
    }
  ],
  "tags": [
    {
      "name": "range",
      "description": "Retrieve a list of hash-password pairs based on a specific prefix."
    },
    {
      "name": "search",
      "description": "Search supplied hash in the database. You do not need to specify exact hash type."
    }
  ],
  "paths": {
    "/range/{prefix}": {
      "get": {
        "tags": [
          "range"
        ],
        "description": "This method allows you to retrieve a list of hash-password pairs based on a specific prefix. Currently, the weakpass4.merged.txt file is used as the precomputed list for these ranges.",
        "parameters": [
          {
            "name": "prefix",
            "in": "path",
            "description": "Hash prefix must have size between 5 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "filter",
            "in": "query",
            "description": "Show only the pass or hash in response",
            "required": false,
            "explode": false,
            "schema": {
              "type": "string",
              "enum": [
                "hash",
                "pass"
              ]
            }
          },
          {
            "name": "type",
            "in": "query",
            "description": "Specify the type of hash list",
            "required": false,
            "explode": false,
            "schema": {
              "default": "md5",
              "type": "string",
              "enum": [
                "md5",
                "ntlm",
                "sha1",
                "sha256"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/pair"
                  }
                }
              }
            }
          },
          "404": {
            "description": "No data with associated prefix"
          },
          "500": {
            "description": "Prefix has invalid characters"
          }
        }
      }
    },
    "/range/{prefix}.json": {
      "get": {
        "tags": [
          "range"
        ],
        "description": "This method allows you to retrieve a list of hash-password pairs based on a specific prefix. Currently, the weakpass4.merged.txt file is used as the precomputed list for these ranges.",
        "parameters": [
          {
            "name": "prefix",
            "in": "path",
            "description": "Hash prefix must have size between 5 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "filter",
            "in": "query",
            "description": "Show only the pass or hash in response",
            "required": false,
            "explode": false,
            "schema": {
              "type": "string",
              "enum": [
                "hash",
                "pass"
              ]
            }
          },
          {
            "name": "type",
            "in": "query",
            "description": "Specify the type of hash list",
            "required": false,
            "explode": false,
            "schema": {
              "default": "md5",
              "type": "string",
              "enum": [
                "md5",
                "ntlm",
                "sha1",
                "sha256"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/pair"
                  }
                }
              }
            }
          },
          "404": {
            "description": "No data with associated prefix"
          },
          "500": {
            "description": "Prefix has invalid characters"
          }
        }
      }
    },
    "/range/{prefix}.txt": {
      "get": {
        "tags": [
          "range"
        ],
        "description": "This method allows you to retrieve a list of hash-password pairs based on a specific prefix. Currently, the weakpass4.merged.txt file is used as the precomputed list for these ranges.",
        "parameters": [
          {
            "name": "prefix",
            "in": "path",
            "description": "Hash prefix must have size between 5 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "filter",
            "in": "query",
            "description": "Show only the pass or hash in response",
            "required": false,
            "explode": false,
            "schema": {
              "type": "string",
              "enum": [
                "hash",
                "pass"
              ]
            }
          },
          {
            "name": "type",
            "in": "query",
            "description": "Specify the type of hash list",
            "required": false,
            "explode": false,
            "schema": {
              "default": "md5",
              "type": "string",
              "enum": [
                "md5",
                "ntlm",
                "sha1",
                "sha256"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "example": "12345678902dd833fc9db9d72e9483c5:4kgdjv1\n12345678910e3b342a0bd4b77050e274:ieaszd4blood\n1234567892266fe0ea42123bc515e746:ryqwww1rwrwe     \n"
                }
              }
            }
          },
          "404": {
            "description": "No data with associated prefix"
          },
          "500": {
            "description": "Prefix has invalid characters"
          }
        }
      }
    },
    "/search/{hash}": {
      "get": {
        "tags": [
          "search"
        ],
        "description": "This method allows you to search for a supplied hash in the database without needing to specify the exact hash type. The system will automatically detect the hash type and return the corresponding results if available.",
        "parameters": [
          {
            "name": "hash",
            "in": "path",
            "description": "Hash prefix must have size between 32 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/hash"
                  }
                }
              }
            }
          },
          "404": {
            "description": "No data with associated hash"
          },
          "500": {
            "description": "General error"
          }
        }
      }
    },
    "/search/{hash}.json": {
      "get": {
        "tags": [
          "search"
        ],
        "description": "This method allows you to search for a supplied hash in the database without needing to specify the exact hash type. The system will automatically detect the hash type and return the corresponding results if available.",
        "parameters": [
          {
            "name": "hash",
            "in": "path",
            "description": "Hash prefix must have size between 32 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/hash"
                  }
                }
              }
            }
          },
          "404": {
            "description": "No data with associated hash"
          },
          "500": {
            "description": "General error"
          }
        }
      }
    },
    "/search/{hash}.txt": {
      "get": {
        "tags": [
          "search"
        ],
        "description": "This method allows you to search for a supplied hash in the database without needing to specify the exact hash type. The system will automatically detect the hash type and return the corresponding results if available.",
        "parameters": [
          {
            "name": "hash",
            "in": "path",
            "description": "Hash prefix must have size between 32 and 64 characters and contains only next chars - [A-Fa-f0-9]",
            "required": true,
            "explode": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "example": "md5;827ccb0eea8a706c4c34a16891f84e7b;12345     \n"
                }
              }
            }
          },
          "404": {
            "description": "No data with associated hash"
          },
          "500": {
            "description": "General error"
          }
        }
      }
    }
  }, 
  "components": {
    "schemas": {
      "pair": {
        "type": "object",
        "properties": {
          "hash": {
            "type": "string",
            "example": "12345678902dd833fc9db9d72e9483c5"
          },
          "pass": {
            "type": "string",
            "example": "4kgdjv1"
          }
        }
      },
      "hash": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "md5",
              "ntlm",
              "sha1",
              "sha256"
            ],
            "example": "md5"
          },
          "hash": {
            "type": "string",
            "example": "12345678902dd833fc9db9d72e9483c5"
          },
          "pass": {
            "type": "string",
            "example": "4kgdjv1"
          }
        }
      }
    }
  }
}